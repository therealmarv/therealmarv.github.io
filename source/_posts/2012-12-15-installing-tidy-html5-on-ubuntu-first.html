---
layout: post
title: "Installing tidy-html5 on Ubuntu, first step to get valid & structured HTML5"
date: 2012-12-15
comments: true
categories:
 - structure
 - html5
 - ubuntu
 - tidy
---

<div class='post'>
At my work (<a href="http://oerpub.org/">OERPUB</a>) we&nbsp;are starting to transform any HTML and especially HTML5 content to a structured HTML5 for further processing into various output formats (html5, epub, pdf, xml).<br /><div><br /></div><div>The problem with transforming HTML5 to a more structured HTML5 is the parsing. The way to make this transformation is currently XSLT and we need XML compatible (X)HTML5 for this.<br /><div><div><br /></div><div>In the past we used <a href="http://tidy.sourceforge.net/">HTML tidy</a>&nbsp;which handles all HTML soup and transforms it to valid XHTML. The only problem is that it is dated, the last version is from <b>2008</b> and it does <b>not</b> support HTML5 (and we also want MathML support).</div><div><br /></div></div></div><div>After some searching we've found <a href="http://w3c.github.com/tidy-html5/">http://w3c.github.com/tidy-html5/</a>&nbsp;which is a fork of tidy with support of HTML5. After my quick tests it seems compatible with the old tidy and (more important for me) also compatible to <a href="http://countergram.com/open-source/pytidylib">pytidylib</a> so that I can still use my old python code but with new HTML5 tidy options. :)</div><div><br /></div><div>Here are instructions on how to replace the old HTML tidy which is included in Ubuntu (tested on 10.04 &amp; 12.04) with the new HTML5 tidy:</div><div><br /></div><div><ol><li>Remove all old tidy implementations<br /><pre class="brush:bash">sudo apt-get remove libtidy-0.99-0 tidy</pre></li><li>Get git, libtool and automake if you do not have them already<br /><pre class="brush:bash">sudo apt-get install git-core automake libtool</pre></li><li>Clone tidy-html5 repository in a directory of your choice<br /><pre class="brush:bash">git clone https://github.com/w3c/tidy-html5<br />cd tidy-html5<br /></pre></li><li>Building the libtidy shared library and install libtidy and tidy program (<a href="http://building%20the%20libtidy%20shared%20library/">copied from here</a>)<br /><pre class="brush:bash">sh build/gnuauto/setup.sh &amp;&amp; ./configure &amp;&amp; make<br />sudo make install<br /></pre></li><li>So tidy and libtidy are now installed but Ubuntu will not find libtidy by default because libtidy installed to the folder "/usr/local/lib" which is normally not searched for runtime libraries. So we have to edit ldconfig's search folders. Open (with root/sudo rights) the file "/etc/ld.so.conf". Example:<br /><pre class="brush:bash">gksu gedit /etc/ld.so.conf<br /></pre></li><li>and add this line to the file "/etc/ld.so.conf"<br /><pre class="brush:text">/usr/local/lib<br /></pre></li><li>Finally restart ldconfig and you are set!<br /><pre class="brush:bash">sudo ldconfig<br /></pre></li></ol><br />Just a side note:<br />To remove HTML5 tidy and install old tidy again just go to its cloned directory and type<br /><pre class="brush:bash">sudo make uninstall<br />sudo apt-get install tidy libtidy-0.99-0<br /></pre><br /></div></div>
